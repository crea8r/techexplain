<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Distributed Consensus - TechExplain</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        dark: {
                            900: '#0a0a0f',
                            800: '#12121a',
                            700: '#1a1a24',
                            600: '#24242f',
                        },
                        accent: {
                            primary: '#6366f1',
                            secondary: '#8b5cf6',
                            glow: '#818cf8',
                        }
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="../../css/styles.css">
    <style>
        .node {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .node:hover {
            transform: scale(1.1);
        }
        .node.receiving {
            animation: node-pulse 0.5s ease-out;
        }
        .node.synced {
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
        }
        @keyframes node-pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
        .connection-line {
            stroke-dasharray: 5, 5;
            animation: dash 1s linear infinite;
        }
        @keyframes dash {
            to { stroke-dashoffset: -10; }
        }
        .tx-particle {
            animation: particle-move 0.8s ease-out forwards;
        }
        @keyframes particle-move {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }
        .ledger-entry {
            animation: fade-in 0.3s ease-out;
        }
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(-5px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-dark-900 text-gray-100 min-h-screen">
    <!-- Header -->
    <header class="border-b border-dark-700">
        <div class="max-w-6xl mx-auto px-6 py-4 flex items-center justify-between">
            <a href="../../index.html" class="flex items-center gap-2 text-gray-400 hover:text-gray-100 transition-colors">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
                <span>Back to Home</span>
            </a>
            <span class="text-sm text-gray-500">TechExplain</span>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-6xl mx-auto px-6 py-8">
        <!-- Title -->
        <div class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold mb-3 bg-gradient-to-r from-accent-primary to-accent-secondary bg-clip-text text-transparent">
                Distributed Consensus
            </h1>
            <p class="text-gray-400 max-w-2xl mx-auto">
                See how multiple nodes in a network receive transactions and synchronize to maintain identical state—the foundation of blockchain technology.
            </p>
        </div>

        <!-- Visualization Area -->
        <div class="bg-dark-800 rounded-2xl border border-dark-600 overflow-hidden mb-6">
            <!-- Network Visualization -->
            <div class="p-6 md:p-8 border-b border-dark-600">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-sm font-semibold text-gray-400 uppercase tracking-wider">Network View</h3>
                    <div class="flex items-center gap-4 text-xs">
                        <div class="flex items-center gap-2">
                            <div class="w-3 h-3 rounded-full bg-gray-500"></div>
                            <span class="text-gray-500">Idle</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                            <span class="text-gray-500">Receiving</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-3 h-3 rounded-full bg-green-500"></div>
                            <span class="text-gray-500">Synced</span>
                        </div>
                    </div>
                </div>

                <!-- Network Canvas -->
                <div id="network-container" class="relative bg-dark-900 rounded-xl h-80 md:h-96 overflow-hidden">
                    <svg id="connections-svg" class="absolute inset-0 w-full h-full pointer-events-none"></svg>
                    <div id="nodes-container" class="absolute inset-0"></div>

                    <!-- Transaction Input Area -->
                    <div id="tx-input" class="absolute left-4 top-1/2 -translate-y-1/2 bg-dark-700 rounded-lg p-3 border border-dark-600 cursor-pointer hover:border-accent-primary transition-all">
                        <div class="text-xs text-gray-500 mb-1">Click to send</div>
                        <div class="text-sm font-mono text-accent-glow">TX</div>
                    </div>
                </div>

                <!-- Status Bar -->
                <div class="mt-4 flex flex-wrap justify-center gap-4 text-sm">
                    <div class="bg-dark-700 rounded-lg px-4 py-2 text-gray-400">
                        Transactions: <span id="tx-count" class="text-accent-glow font-mono">0</span>
                    </div>
                    <div class="bg-dark-700 rounded-lg px-4 py-2 text-gray-400">
                        Synced Nodes: <span id="synced-count" class="text-green-400 font-mono">0</span> / <span id="total-nodes" class="font-mono">5</span>
                    </div>
                    <div class="bg-dark-700 rounded-lg px-4 py-2 text-gray-400">
                        Network State: <span id="network-state" class="text-gray-100">Idle</span>
                    </div>
                </div>
            </div>

            <!-- Node Inspector -->
            <div class="p-6 md:p-8 border-b border-dark-600 bg-dark-900/50">
                <div class="flex items-center gap-2 mb-4">
                    <svg class="w-5 h-5 text-accent-glow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                    </svg>
                    <h3 class="text-sm font-semibold text-gray-400 uppercase tracking-wider">Node Inspector</h3>
                    <span class="text-xs text-gray-500">(click a node to inspect)</span>
                </div>
                <div class="grid md:grid-cols-2 gap-4">
                    <!-- Selected Node Info -->
                    <div class="bg-dark-800 rounded-lg p-4 border border-dark-600">
                        <div class="text-xs font-medium text-cyan-400 mb-2">SELECTED NODE</div>
                        <div id="selected-node-info" class="text-sm text-gray-300">
                            <span class="text-gray-500 italic">No node selected</span>
                        </div>
                    </div>
                    <!-- Node's Ledger -->
                    <div class="bg-dark-800 rounded-lg p-4 border border-dark-600">
                        <div class="text-xs font-medium text-purple-400 mb-2">NODE'S LEDGER</div>
                        <div id="node-ledger" class="text-sm font-mono text-gray-300 max-h-24 overflow-y-auto">
                            <span class="text-gray-500 italic">Select a node to view ledger</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="p-6 md:p-8 bg-dark-700/50">
                <div class="flex flex-wrap items-center justify-between gap-4">
                    <!-- Left: Transaction Input -->
                    <div class="flex items-center gap-4">
                        <div class="flex items-center gap-2">
                            <label class="text-sm text-gray-400">Amount:</label>
                            <input type="number" id="tx-amount" value="100" min="1" max="9999"
                                class="bg-dark-700 border border-dark-600 rounded-lg px-3 py-2 text-sm w-24 focus:outline-none focus:border-accent-primary">
                        </div>
                        <div class="flex items-center gap-2">
                            <label class="text-sm text-gray-400">From:</label>
                            <input type="text" id="tx-from" value="Alice" maxlength="10"
                                class="bg-dark-700 border border-dark-600 rounded-lg px-3 py-2 text-sm w-24 focus:outline-none focus:border-accent-primary">
                        </div>
                        <div class="flex items-center gap-2">
                            <label class="text-sm text-gray-400">To:</label>
                            <input type="text" id="tx-to" value="Bob" maxlength="10"
                                class="bg-dark-700 border border-dark-600 rounded-lg px-3 py-2 text-sm w-24 focus:outline-none focus:border-accent-primary">
                        </div>
                    </div>

                    <!-- Center: Action Buttons -->
                    <div class="flex items-center gap-3">
                        <button id="btn-send-tx" class="btn-primary px-6 py-2 rounded-lg font-medium text-white">
                            Send Transaction
                        </button>
                        <button id="btn-reset" class="btn-secondary px-6 py-2 rounded-lg font-medium text-gray-300">
                            Reset Network
                        </button>
                    </div>

                    <!-- Right: Speed -->
                    <div class="flex items-center gap-2">
                        <label class="text-sm text-gray-400">Speed:</label>
                        <select id="speed-select" class="bg-dark-700 border border-dark-600 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-accent-primary">
                            <option value="slow">Slow</option>
                            <option value="medium" selected>Medium</option>
                            <option value="fast">Fast</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>

        <!-- Explanation Section -->
        <div class="bg-dark-800 rounded-2xl border border-dark-600 p-6 md:p-8">
            <h2 class="text-xl font-semibold mb-6 text-gray-100">How Distributed Consensus Works</h2>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="text-center">
                    <div class="w-12 h-12 mx-auto mb-3 rounded-xl bg-blue-500/20 flex items-center justify-center">
                        <svg class="w-6 h-6 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16l-4-4m0 0l4-4m-4 4h18"></path>
                        </svg>
                    </div>
                    <h3 class="font-medium text-blue-400 mb-2">1. Broadcast</h3>
                    <p class="text-gray-400 text-sm">
                        A transaction is sent to the network. It reaches one node first, then spreads to connected peers.
                    </p>
                </div>
                <div class="text-center">
                    <div class="w-12 h-12 mx-auto mb-3 rounded-xl bg-yellow-500/20 flex items-center justify-center">
                        <svg class="w-6 h-6 text-yellow-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                        </svg>
                    </div>
                    <h3 class="font-medium text-yellow-400 mb-2">2. Propagate</h3>
                    <p class="text-gray-400 text-sm">
                        Each node validates the transaction and forwards it to its neighbors until all nodes receive it.
                    </p>
                </div>
                <div class="text-center">
                    <div class="w-12 h-12 mx-auto mb-3 rounded-xl bg-green-500/20 flex items-center justify-center">
                        <svg class="w-6 h-6 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <h3 class="font-medium text-green-400 mb-2">3. Consensus</h3>
                    <p class="text-gray-400 text-sm">
                        All nodes agree on the transaction and update their ledgers. The network reaches synchronized state.
                    </p>
                </div>
            </div>
            <div class="mt-8 p-4 bg-dark-700 rounded-lg border border-dark-600">
                <h3 class="font-medium text-accent-glow mb-2">Why This Matters</h3>
                <p class="text-gray-400 text-sm">
                    In traditional systems, a central server holds the "truth." In distributed networks, every node maintains
                    an identical copy of the ledger. This redundancy makes the system resilient—no single point of failure,
                    no single entity to trust. Click different nodes to verify they all have the same transaction history.
                </p>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="max-w-6xl mx-auto px-6 py-8 text-center">
        <a href="../../index.html" class="text-accent-primary hover:text-accent-glow transition-colors text-sm">
            ← Back to all interactives
        </a>
    </footer>

    <script src="../../js/distributed-network.js"></script>
</body>
</html>
